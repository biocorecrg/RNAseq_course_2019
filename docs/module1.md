---
layout: page
title: Module 1
navigation: 2
---

# Module 1
## Introduction: what is RNA-Seq? 

|RNA molecule|
| :---:  |
|<img src="images/Double-stranded_RNA.gif" width="300" align="middle" />|
|from Wikipedia|


RNA sequencing is a technique that allows to detect and quantify RNA molecules within biological samples by using next-generation sequencing (NGS). In few words this technology is used to analyze the transcriptome by revealing:
* gene expression
* alternative spliced transcripts 
* gene fusion and SNPs
* RNA editing

Other experiments used for assessing the RNA expression are Northern Blot [1], Real time PCR [2] and hybridization-based  microarray [3].

RNA-Seq can be performed on:
* Only messenger RNAs by performing polyA enrichment. 
* total RNA, after a step of ribosomal depletion.
* small RNAs, selecting the size of RNA molecule (usually < 100 nt)
* Only RNA molecules that are being transcribed in that moment (ribosomal profiling).

Depending on the kind of sequencing the RNAseq can produce:
* Single short reads: particularly used for gene quantification (mainly **Illumina**, but also **Ion Torrent** and **BGISEQ**)
* Paired end reads: useful for splicing detection and annotation refinement
* Stranded or unstranded: the former allows detection of antisense molecules or genes on both directions, the latter is sometimes needed when very little amount of RNA is available. 
* Single long reads (**PACBio** or **Nanopore**): used for de novo identification of new transcripts / improving transcriptome. 

## mRNA sequencing (Illumina)
RNA is extracted and then converted to cDNA by using a polyT adapter that binds the polyA tail. In this way non poly-adenylated transcripts like rRNA, tRNA and the majority of long ncRNAs are excluded from the reaction. 
cDNA molecules are then fragmented and eventually amplified by PCR and then sequenced.
Short reads are then mapped to the reference genome / transcriptome and assigned to a gene / transcript. 
The number of reads per gene / transcript is finally used as a proxy of the expression of that gene / transcript.


|RNASeq protocol|
| :---:  |
|<img src="images/tileshop.jpeg" align="middle" />|
|from Wang et al 2009 [4]|

<br/>
To achieve to sequence only one of the two DNA strand the **Illumina's TruSeq Stranded mRNA** protocol requires the introduction of dUTP instead of dTTP during the amplification. In this way that filament is NOT amplified / sequenced. 
<br/>
<img src="images/illumina1.png" width="500" align="middle" />
<img src="images/illumina2.png" width="500" align="middle" />
<img src="images/illumina3.png" width="500" align="middle" />
<br/>
At the end of the sequence an extra "A" is added at the 3' end to minimize the amount of chimaeras generated by the concatenations of blunt ends. 
<br/><br/>
<img src="images/illumina4.png" width="500" align="middle" />
<img src="images/illumina5.png" width="500" align="middle" />
<img src="images/illumina6.png" width="500" align="middle" />
<br/>

## Input data: fastq sequences

Short (and long) reads coming from the sequencers are stored in **Fastq** format.
This format contains both the information about sequence and the quality of that particular base (i.e. the probability that that base reading was true or not).

<img src="images/fastq_format.png" width="500"/>

The format contains four rows for sequence with:
* a header containing **@** as the first character
* the sequence content
* a **spacer**
* the quality encoded using ASCII characters.

<img src="images/phred_quality.png" width="500"/>

Currently most of the journals require the submissions of NGS raw data in a public repository upon publishing.

The major repositories are:
* [**SRA**](https://www.ncbi.nlm.nih.gov/sra) (Sequence Read Archive) from US
* [**ENA**](https://www.ebi.ac.uk/ena) (European Nucleotide Archive) 
* [**DDBJ-DRA**](https://www.ddbj.nig.ac.jp/dra/index-e.html) from Japan.

They are interconnected and mirror the data among them and contain links to other databases that store the gene expression  such as [**GEO**](https://www.ncbi.nlm.nih.gov/geo/) and [**Array-express**](https://www.ebi.ac.uk/arrayexpress/).

```{bash}
fastq-dump --gzip --split-files SRR6466185

Read 32345 spots for SRR6466185
Written 32345 spots for SRR6466185

ls -lh SRR*
-rw-r--r-- 1 lcozzuto Bioinformatics_Unit 6.4M Mar  8 12:01 SRR6466185_1.fastq.gz
-rw-r--r-- 1 lcozzuto Bioinformatics_Unit 7.5M Mar  8 12:01 SRR6466185_2.fastq.gz

```


## References:

1. https://en.wikipedia.org/wiki/Northern_blot
2. https://en.wikipedia.org/wiki/Real-time_polymerase_chain_reaction
3. https://en.wikipedia.org/wiki/DNA_microarray
4. [Wang Z, Gerstein M, Snyder M. RNA-Seq: a revolutionary tool for transcriptomics. Nat Rev Genet. 2009 Jan;10(1):57-63. doi: 10.1038/nrg2484.](https://www.nature.com/articles/nrg2484)
